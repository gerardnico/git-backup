#!/bin/bash

# ! [rejected]        master -> master (non-fast-forward)
#error: failed to push some refs to 'https://gerardnico:ghp_glKrr7@github.com/ComboStrap/website'
#hint: Updates were rejected because the tip of your current branch is behind
#hint: its remote counterpart. Merge the remote changes (e.g. 'git pull')
#hint: before pushing again.
#hint: See the 'Note about fast-forwards' in 'git push --help' for details.

function git_auto_push() {

  # pull to avoid
  # `Updates were rejected because the tip of your current branch is behind`
  git pull

  # staged all changes
  git add -A

  # commit message
  declare -a files
  for path in $(git diff-index --name-only HEAD); do
    files+=(" ${path##*/}")
  done
  fileList=$(
    IFS=$', '
    echo "${files[*]}"
  )
  message="Update$fileList"
  echo "$message"

  # commit
  git-auto-commit "$message"

  # push
  git-commit-status
  git push

}

git_auto_push